<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>–ú—ã –ª—é–±–∏–º –ê—Å–∞–ª—å</title>
<style>
  :root {
    --blue: #4da8ff;
    --blue-dark: #003087;
    --font: 'Segoe UI', sans-serif;
  }
  * {
    box-sizing: border-box;
  }
  html, body {
    margin: 0; padding: 0;
    height: 100vh; width: 100vw;
    font-family: var(--font);
    background: linear-gradient(135deg, #001d3d, #003087);
    animation: bgshift 15s infinite alternate ease-in-out;
    color: white;
    overflow-x: hidden;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    position: relative;
  }
  /* Starry background */
  .stars, .stars2, .stars3 {
    position: absolute;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: transparent;
    z-index: -1;
  }
  .stars {
    background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg"><circle cx="2" cy="2" r="2" fill="white"/></svg>') repeat;
    background-size: 40px 40px;
    opacity: 0.9;
    filter: blur(1.5px);
    animation: twinkle 10s infinite ease-in-out;
  }
  .stars2 {
    background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg"><circle cx="3" cy="3" r="3" fill="white"/></svg>') repeat;
    background-size: 60px 60px;
    opacity: 0.7;
    filter: blur(1px);
    animation: twinkle 8s infinite ease-in-out;
  }
  .stars3 {
    background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="4" r="4" fill="white"/></svg>') repeat;
    background-size: 80px 80px;
    opacity: 0.5;
    filter: blur(0.5px);
    animation: twinkle 6s infinite ease-in-out;
  }
  @keyframes twinkle {
    0% { opacity: 0.5; transform: scale(0.6); }
    50% { opacity: 1; transform: scale(1); }
    100% { opacity: 0.5; transform: scale(0.6); }
  }
  @keyframes bgshift {
    0% { background: linear-gradient(135deg, #001d3d, #003087); }
    100% { background: linear-gradient(135deg, #003087, #001d3d); }
  }
  /* Animation for diving and rising */
  .container {
    display: none;
    flex-direction: column;
    align-items: center;
    width: 100%;
    position: relative;
    z-index: 1;
  }
  .container.visible {
    display: flex;
    animation: none;
  }
  .submenu.visible {
    animation: dive 1.5s cubic-bezier(0.4, 0, 0.2, 1) forwards;
  }
  .submenu:not(.visible) {
    animation: dive-out 1.5s cubic-bezier(0.4, 0, 0.2, 1) forwards;
  }
  .menu.visible, .auth.visible {
    animation: rise 1.5s cubic-bezier(0.4, 0, 0.2, 1) forwards;
  }
  @keyframes dive {
    0% { transform: translateY(-100vh) scale(0.6); opacity: 0; }
    100% { transform: translateY(0) scale(1); opacity: 1; }
  }
  @keyframes dive-out {
    0% { transform: translateY(0) scale(1); opacity: 1; }
    100% { transform: translateY(100vh) scale(0.6); opacity: 0; }
  }
  @keyframes rise {
    0% { transform: translateY(100vh) scale(0.6); opacity: 0; }
    100% { transform: translateY(0) scale(1); opacity: 1; }
  }
  body.transitioning {
    pointer-events: none;
  }
  #intro {
    position: fixed;
    top: 0; left: 0; width: 100vw; height: 100vh;
    background: #001d3d;
    color: white;
    font-size: 3em;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 9999;
    opacity: 1;
    animation: introfade 3s ease forwards;
  }
  @keyframes introfade {
    0%, 90% { opacity: 1; }
    100% { opacity: 0; visibility: hidden; }
  }
  button {
    background: var(--blue);
    border: none;
    color: white;
    padding: 10px 25px;
    margin: 10px;
    border-radius: 12px;
    font-size: 1rem;
    cursor: pointer;
    width: 90vw;
    max-width: 300px;
    transition: background 0.3s ease, transform 0.3s ease;
  }
  button:hover {
    background: var(--blue-dark);
    transform: scale(1.05);
  }
  button:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
  input[type=password] {
    padding: 10px;
    border-radius: 8px;
    margin: 10px;
    font-size: 16px;
    border: 1px solid var(--blue);
    background: transparent;
    color: white;
    width: 80vw;
    max-width: 300px;
    -webkit-text-security: disc;
  }
  #version {
    position: fixed;
    top: 10px;
    right: 20px;
    font-size: 13px;
    color: #aaa;
    z-index: 10000;
  }
  #adminBtn {
    position: fixed;
    top: 10px;
    left: 20px;
    font-size: 13px;
    z-index: 10000;
  }
  #asalScreen {
    font-size: 2.2em;
    text-align: center;
    color: var(--blue);
    animation: neon 2s ease-in-out infinite alternate;
    letter-spacing: 2px;
    padding: 20px;
    margin-bottom: 20px;
  }
  @keyframes neon {
    0% { text-shadow: 0 0 5px rgba(77, 168, 255, 0.5); }
    100% { text-shadow: 0 0 10px rgba(77, 168, 255, 0.8); }
  }
  iframe {
    width: 95vw;
    height: 60vh;
    margin: 10px auto;
    border: none;
    display: block;
  }
  audio, video {
    width: 95vw;
    max-height: 40vh;
    margin: 10px auto;
    display: block;
  }
  audio.hidden {
    display: none;
  }
</style>
</head>
<body>
  <div class="stars"></div>
  <div class="stars2"></div>
  <div class="stars3"></div>
  <div id="intro">Said</div>
  <div id="version">v2.1</div>
  <button id="adminBtn">–ö—Ä–µ–∞—Ç–æ—Ä</button>

  <div class="container auth hidden">
    <input id="tokenInput" type="password" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–æ–∫–µ–Ω" autocomplete="off" />
    <button id="loginBtn">–í–æ–π—Ç–∏</button>
  </div>

  <div class="container menu hidden">
    <button data-menu="musicMenu">–ü–µ—Å–Ω—è</button>
    <button data-menu="videoMenu">–ö–Ω–æ–ø–∫–∞ –ù–ï –Ω–∞–∂–∏–º–∞—Ç—å</button>
    <button data-menu="asalMenu">üíñ –ú—ã –ª—é–±–∏–º –ê—Å–∞–ª—å</button>
    <button data-menu="gdzMenu">–ì–î–ó</button>
    <button id="logoutBtn">–í—ã—Ö–æ–¥</button>
  </div>

  <div class="container submenu hidden" id="musicMenu">
    <audio id="audio" controls class="hidden"></audio>
    <button data-audio="round-start.mp3">–ê–º–æ–Ω–≥ –ê—Å</button>
    <button data-audio="tum-tum-tum-sahur.mp3">–¢—É–º –¢—É–º –°–∞—Ö—É—Ä</button>
    <button data-audio="audio_2025-08-01_23-01-57.mp3">–≠—Ç–æ –Ω–µ –∑–∞–±—É–¥–µ–º –¢–∏–º—É—Ä–∞</button>
    <button class="back">–ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é</button>
  </div>

  <div class="container submenu hidden" id="videoMenu">
    <video id="video" controls class="hidden"></video>
    <button data-video="oY9EGRFUCQDcF7MAKmJgfVEloRIiRIjFkerREB.mp4">–¢–∏–º—É—Ä</button>
    <button data-video="oMTvPfb7222222.mp4">–ú–ì–†–†</button>
    <button class="back">–ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é</button>
  </div>

  <div class="container submenu hidden" id="asalMenu">
    <audio id="asalAudio"></audio>
    <div id="asalScreen">üíñ –ú—ã –ª—é–±–∏–º –ê—Å–∞–ª—å üíñ</div>
    <button class="back">–ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é</button>
  </div>

  <div class="container submenu hidden" id="gdzMenu">
    <iframe src="" id="gdzFrame" sandbox="allow-same-origin allow-scripts allow-popups" allowfullscreen></iframe>
    <button data-gdzkey="english">–ì–î–ó –ê–Ω–≥–ª–∏–π—Å–∫–∏–π</button>
    <button class="back">–ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é</button>
  </div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-app.js";
  import { getDatabase, ref, get, set, remove } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyBTcH3_tri2L7AHLh1e-YD-0s-QSthuE6Q",
    authDomain: "disk-c98ee.firebaseapp.com",
    projectId: "disk-c98ee",
    storageBucket: "disk-c98ee.appspot.com",
    messagingSenderId: "59577059636",
    appId: "1:59577059636:web:e98f456d054cc360747d61",
    databaseURL: "https://disk-c98ee-default-rtdb.firebaseio.com"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);

  const tokenInput = document.getElementById('tokenInput');
  const loginBtn = document.getElementById('loginBtn');
  const auth = document.querySelector('.auth');
  const menu = document.querySelector('.menu');
  const audio = document.getElementById('audio');
  const video = document.getElementById('video');
  const asalAudio = document.getElementById('asalAudio');
  const gdzFrame = document.getElementById('gdzFrame');
  const musicMenu = document.getElementById('musicMenu');
  const videoMenu = document.getElementById('videoMenu');
  const asalMenu = document.getElementById('asalMenu');
  const gdzMenu = document.getElementById('gdzMenu');
  const backButtons = document.querySelectorAll('.back');
  const adminBtn = document.getElementById('adminBtn');

  function showElement(el) {
    if (!el) return;
    console.log('Showing element:', el.id || el.className);
    el.classList.remove('hidden');
    el.classList.add('visible');
    document.body.classList.add('transitioning');
    setTimeout(() => document.body.classList.remove('transitioning'), 1500);
  }

  function hideElement(el) {
    if (!el) return;
    console.log('Hiding element:', el.id || el.className);
    el.classList.remove('visible');
    el.classList.add('hidden');
  }

  function hideElements(elements) {
    elements.forEach(el => hideElement(el));
  }

  function openMenu(menuId) {
    console.log('Opening menu:', menuId);
    hideElements([menu, auth, ...document.querySelectorAll('.submenu')]);
    audio.pause(); audio.classList.add('hidden'); audio.src = '';
    video.pause(); video.classList.add('hidden'); video.src = '';
    asalAudio.pause(); asalAudio.classList.add('hidden'); asalAudio.src = '';
    const el = document.getElementById(menuId);
    if (el) {
      showElement(el);
      if (menuId === 'asalMenu') {
        asalAudio.src = 'pool.mp3';
        asalAudio.play().catch(err => console.error('Asal audio playback error:', err));
      }
    }
  }

  async function checkToken(token) {
    try {
      const snapshot = await get(ref(db, 'tokens/' + token));
      console.log('Token check result:', snapshot.exists());
      return snapshot.exists();
    } catch (error) {
      console.error('Token check error:', error);
      return false;
    }
  }

  loginBtn.addEventListener('click', async () => {
    const token = tokenInput.value.trim();
    if (!token) return alert('–í–≤–µ–¥–∏—Ç–µ —Ç–æ–∫–µ–Ω');
    loginBtn.disabled = true;
    const valid = await checkToken(token);
    loginBtn.disabled = false;
    if (valid) {
      console.log('Login successful');
      hideElement(auth);
      showElement(menu);
    } else {
      alert('–ù–µ–≤–µ—Ä–Ω—ã–π —Ç–æ–∫–µ–Ω');
    }
  });

  document.getElementById('logoutBtn').addEventListener('click', () => {
    console.log('Logging out');
    hideElement(menu);
    hideElements(document.querySelectorAll('.submenu'));
    tokenInput.value = '';
    showElement(auth);
  });

  menu.querySelectorAll('button[data-menu]').forEach(btn => {
    btn.addEventListener('click', (e) => {
      e.stopPropagation();
      console.log('Menu button clicked:', btn.getAttribute('data-menu'));
      hideElement(menu);
      const menuId = btn.getAttribute('data-menu');
      openMenu(menuId);
    });
  });

  backButtons.forEach(btn => {
    btn.addEventListener('click', (e) => {
      e.stopPropagation();
      console.log('Back button clicked');
      hideElements(document.querySelectorAll('.submenu'));
      showElement(menu);
    });
  });

  musicMenu.querySelectorAll('button[data-audio]').forEach(btn => {
    btn.addEventListener('click', (e) => {
      e.stopPropagation();
      console.log('Audio button clicked:', btn.getAttribute('data-audio'));
      const audioFile = btn.getAttribute('data-audio');
      video.pause();
      video.classList.add('hidden');
      asalAudio.pause();
      asalAudio.classList.add('hidden');
      audio.src = audioFile;
      audio.classList.remove('hidden');
      audio.play().catch(err => console.error('Audio playback error:', err));
    });
  });

  videoMenu.querySelectorAll('button[data-video]').forEach(btn => {
    btn.addEventListener('click', (e) => {
      e.stopPropagation();
      console.log('Video button clicked:', btn.getAttribute('data-video'));
      const videoFile = btn.getAttribute('data-video');
      audio.pause();
      audio.classList.add('hidden');
      asalAudio.pause();
      asalAudio.classList.add('hidden');
      video.src = videoFile;
      video.classList.remove('hidden');
      video.play().catch(err => console.error('Video playback error:', err));
    });
  });

  // –ì–î–ó –º–µ–Ω—é
  const gdzUrls = {
    'english': 'https://gdz.ru/class-7/english/spotlight-7/'
  };

  gdzMenu.querySelectorAll('button[data-gdzkey]').forEach(btn => {
    btn.addEventListener('click', (e) => {
      e.stopPropagation();
      console.log('GDZ button clicked:', btn.getAttribute('data-gdzkey'));
      const key = btn.getAttribute('data-gdzkey');
      if (gdzUrls[key]) {
        gdzFrame.src = gdzUrls[key];
      }
    });
  });

  adminBtn.addEventListener('click', async () => {
    const adminToken = prompt('–í–≤–µ–¥–∏—Ç–µ –∞–¥–º–∏–Ω —Ç–æ–∫–µ–Ω');
    if (adminToken !== 'admin123') {
      alert('–ù–µ–≤–µ—Ä–Ω—ã–π –∞–¥–º–∏–Ω —Ç–æ–∫–µ–Ω');
      return;
    }
    const panel = document.createElement('div');
    panel.style = `
      position: fixed; top: 50px; left: 50%; transform: translateX(-50%);
      background: #001d3d; color: white; padding: 20px; border-radius: 10px;
      z-index: 100000; max-width: 400px; width: 90vw;
      max-height: 70vh; overflow-y: auto;
    `;
    panel.innerHTML = `
      <h2>–ê–¥–º–∏–Ω–∫–∞: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞–º–∏</h2>
      <input id="newTokenInput" placeholder="–ù–æ–≤—ã–π —Ç–æ–∫–µ–Ω" style="width: 80%; padding: 8px; margin-bottom: 10px; border-radius: 6px; border: 1px solid var(--blue); background: transparent; color: white;" />
      <button id="addTokenBtn">–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–∫–µ–Ω</button>
      <button id="closeAdminBtn" style="margin-left: 10px; background: var(--blue-dark);">–ó–∞–∫—Ä—ã—Ç—å</button>
      <div id="tokensList" style="margin-top: 15px;"></div>
    `;
    document.body.appendChild(panel);

    const newTokenInput = panel.querySelector('#newTokenInput');
    const addTokenBtn = panel.querySelector('#addTokenBtn');
    const closeAdminBtn = panel.querySelector('#closeAdminBtn');
    const tokensList = panel.querySelector('#tokensList');

    async function updateTokensList() {
      tokensList.innerHTML = '–ó–∞–≥—Ä—É–∑–∫–∞...';
      const snapshot = await get(ref(db, 'tokens'));
      if (snapshot.exists()) {
        const tokens = snapshot.val();
        tokensList.innerHTML = '';
        Object.keys(tokens).forEach(t => {
          const tokenEl = document.createElement('div');
          tokenEl.style = 'display:flex; justify-content:space-between; margin-bottom:6px; border-bottom: 1px solid #444; padding-bottom:4px;';
          tokenEl.textContent = t;
          const delBtn = document.createElement('button');
          delBtn.textContent = '–£–¥–∞–ª–∏—Ç—å';
          delBtn.style.background = '#a00';
          delBtn.style.color = 'white';
          delBtn.style.border = 'none';
          delBtn.style.borderRadius = '6px';
          delBtn.style.cursor = 'pointer';
          delBtn.addEventListener('click', async () => {
            await remove(ref(db, 'tokens/' + t));
            updateTokensList();
          });
          tokenEl.appendChild(delBtn);
          tokensList.appendChild(tokenEl);
        });
      } else {
        tokensList.textContent = '–¢–æ–∫–µ–Ω—ã –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç';
      }
    }

    addTokenBtn.addEventListener('click', async () => {
      const newToken = newTokenInput.value.trim();
      if (!newToken) return alert('–í–≤–µ–¥–∏—Ç–µ —Ç–æ–∫–µ–Ω –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è');
      await set(ref(db, 'tokens/' + newToken), true);
      newTokenInput.value = '';
      updateTokensList();
    });

    closeAdminBtn.addEventListener('click', () => {
      panel.remove();
    });

    updateTokensList();
  });

  window.addEventListener('load', () => {
    setTimeout(() => {
      const intro = document.getElementById('intro');
      intro.style.display = 'none';
      showElement(auth);
    }, 3000);
  });
</script>
</body>
</html>
